

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>moldesign.molecules package &mdash; Molecular Design Toolkit 0.7.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Molecular Design Toolkit 0.7.0 documentation" href="../index.html"/>
        <link rel="up" title="moldesign package" href="moldesign.html"/>
        <link rel="next" title="moldesign.orbitals package" href="moldesign.orbitals.html"/>
        <link rel="prev" title="moldesign.models package" href="moldesign.models.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../contents.html" class="icon icon-home"> Molecular Design Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                0.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howdoi.html">How do I ...?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure.html">Atoms, molecules, and biomolecules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="moldesign.html">Complete API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="moldesign.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="moldesign.compute.html">moldesign.compute package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.external.html">moldesign.external package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.forcefields.html">moldesign.forcefields package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.geom.html">moldesign.geom package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.integrators.html">moldesign.integrators package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.interfaces.html">moldesign.interfaces package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.min.html">moldesign.min package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.models.html">moldesign.models package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">moldesign.molecules package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-moldesign.molecules.atomcollections">moldesign.molecules.atomcollections module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#moldesign-molecules-atoms-module">moldesign.molecules.atoms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-moldesign.molecules.biounits">moldesign.molecules.biounits module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-moldesign.molecules.bonds">moldesign.molecules.bonds module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-moldesign.molecules.coord_arrays">moldesign.molecules.coord_arrays module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#moldesign-molecules-molecule-module">moldesign.molecules.molecule module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-moldesign.molecules.trajectory">moldesign.molecules.trajectory module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.orbitals.html">moldesign.orbitals package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.uibase.html">moldesign.uibase package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.units.html">moldesign.units package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.utils.html">moldesign.utils package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.viewer.html">moldesign.viewer package</a></li>
<li class="toctree-l3"><a class="reference internal" href="moldesign.widgets.html">moldesign.widgets package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.converters">moldesign.converters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.data">moldesign.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.exceptions">moldesign.exceptions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.helpers">moldesign.helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.mathutils">moldesign.mathutils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.method">moldesign.method module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.parameters">moldesign.parameters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moldesign.html#module-moldesign.tools">moldesign.tools module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../contents.html">Molecular Design Toolkit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../contents.html">Docs</a> &raquo;</li>
      
          <li><a href="moldesign.html">moldesign package</a> &raquo;</li>
      
    <li>moldesign.molecules package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/_moldesign_api/moldesign.molecules.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="moldesign-molecules-package">
<h1>moldesign.molecules package<a class="headerlink" href="#moldesign-molecules-package" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-moldesign.molecules"></span><dl class="class">
<dt id="moldesign.molecules.AtomList">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">AtomList</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.AtomList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">list</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a></p>
<p>A list of atoms that allows attribute &#8220;slicing&#8221; - accessing an attribute of the
list will return a list of atom attributes.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atomlist</span><span class="o">.</span><span class="n">mass</span> <span class="o">==</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atomlist</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">getattr</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atomlist</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="moldesign.molecules.AtomList.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.AtomList.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a synonym for self so that AtomContainer methods will work here too</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Bond">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Bond</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>order=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/bonds.html#Bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A bond between two atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a1</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; First atom</li>
<li><strong>a2</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; Second atom (the order of atoms doesn&#8217;t matter)</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Order of the bond</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Comparisons and hashes involving bonds will return True if the atoms involved in the bonds</dt>
<dd>are the same. Bond orders are not compared.</dd>
</dl>
<p>These objects are used to represent and pass bond data only - they are not used for storage.</p>
<dl class="attribute">
<dt id="moldesign.molecules.Bond.a1">
<code class="descname">a1</code><a class="headerlink" href="#moldesign.molecules.Bond.a1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Atom</em> &#8211; First atom in the bond; assigned so that <code class="docutils literal"><span class="pre">self.a1.index</span> <span class="pre">&lt;</span> <span class="pre">self.a2.index</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Bond.a2">
<code class="descname">a2</code><a class="headerlink" href="#moldesign.molecules.Bond.a2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Atom</em> &#8211; Second atom in the bond; assigned so that <code class="docutils literal"><span class="pre">self.a2.index</span> <span class="pre">&gt;</span> <span class="pre">self.a1.index</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Bond.order">
<code class="descname">order</code><a class="headerlink" href="#moldesign.molecules.Bond.order" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; bond order (can be <code class="docutils literal"><span class="pre">None</span></code>); not used in comparisons</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Bond.ff">
<code class="descname">ff</code><a class="headerlink" href="#moldesign.molecules.Bond.ff" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.forcefield.BondTerm</em> &#8211; the force-field term for this bond (or <code class="docutils literal"><span class="pre">None</span></code> if no
forcefield is present)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Bond.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.Bond.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; name of the bond</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Bond.partner">
<code class="descname">partner</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/bonds.html#Bond.partner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Bond.partner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this atom&#8217;s <em>partner</em> in the bond &#8211; i.e., the other atom in the bond</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong> (<em>mdt.Atom</em>) &#8211; return the atom that this one is bonded to</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the passed atom&#8217;s partner</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mdt.Atom</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if the passed atom is not part of this bond</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Atom">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>name=None</em>, <em>atnum=None</em>, <em>mass=None</em>, <em>chain=None</em>, <em>residue=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>element=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atoms.AtomDrawingMixin" title="moldesign.molecules.atoms.AtomDrawingMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomDrawingMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomGeometryMixin" title="moldesign.molecules.atoms.AtomGeometryMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomGeometryMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomPropertyMixin" title="moldesign.molecules.atoms.AtomPropertyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomPropertyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomReprMixin" title="moldesign.molecules.atoms.AtomReprMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomReprMixin</span></code></a></p>
<p>A data structure representing an atom.</p>
<p><code class="docutils literal"><span class="pre">Atom</span></code> objects store information about individual atoms within a larger molecular system,
providing access to atom-specific geometric, biomolecular, topological and property
information. Each <a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> is composed of a list of atoms.</p>
<p>Atoms can be instantiated directly, but they will generally be created
automatically as part of molecules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The atom&#8217;s name (if not passed, set to the element name + the atom&#8217;s index)</li>
<li><strong>atnum</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Atomic number (if not passed, determined from element if possible)</li>
<li><strong>mass</strong> (<em>units.Scalar[mass]</em>) &#8211; The atomic mass (if not passed, set to the most abundant isotopic
mass)</li>
<li><strong>chain</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Chain" title="moldesign.Chain"><em>moldesign.Chain</em></a>) &#8211; biomolecular chain that this atom belongs to</li>
<li><strong>residue</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Residue" title="moldesign.Residue"><em>moldesign.Residue</em></a>) &#8211; biomolecular residue that this atom belongs to</li>
<li><strong>pdbname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name from PDB entry, if applicable</li>
<li><strong>pdbindex</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; atom serial number in the PDB entry, if applicable</li>
<li><strong>element</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Elemental symbol (if not passed, determined from atnum if possible)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Atom instance attributes:</strong></p>
<dl class="attribute">
<dt id="moldesign.molecules.Atom.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.Atom.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; A descriptive name for this atom</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.element">
<code class="descname">element</code><a class="headerlink" href="#moldesign.molecules.Atom.element" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; IUPAC elemental symbol (&#8216;C&#8217;, &#8216;H&#8217;, &#8216;Cl&#8217;, etc.)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.index">
<code class="descname">index</code><a class="headerlink" href="#moldesign.molecules.Atom.index" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; the atom&#8217;s current index in the molecule
(<code class="docutils literal"><span class="pre">self</span> <span class="pre">is</span> <span class="pre">self.parent.atoms[</span> <span class="pre">self.index]</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.atnum">
<code class="descname">atnum</code><a class="headerlink" href="#moldesign.molecules.Atom.atnum" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; atomic number (synonyms: atomic_num)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.mass">
<code class="descname">mass</code><a class="headerlink" href="#moldesign.molecules.Atom.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[mass]</em> &#8211; the atom&#8217;s mass</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.position">
<code class="descname">position</code><a class="headerlink" href="#moldesign.molecules.Atom.position" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[length]</em> &#8211; atomic position vector. Once an atom is part of a molecule,
this quantity will refer to <code class="docutils literal"><span class="pre">self.molecule.positions[self.index]</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.momentum">
<code class="descname">momentum</code><a class="headerlink" href="#moldesign.molecules.Atom.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[momentum]</em> &#8211; atomic momentum vector. Once an atom is part of a
molecule, this quantity will refer to <code class="docutils literal"><span class="pre">self.molecule.momenta[self.index]</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">x,y,z</code></dt>
<dd><p><em>u.Scalar[length]</em> &#8211; x, y, and z components of <code class="docutils literal"><span class="pre">atom.position</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">vx, vy, vz</code></dt>
<dd><p><em>u.Scalar[length/time]</em> &#8211; x, y, of <code class="docutils literal"><span class="pre">atom.velocity</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">px, py, pz</code></dt>
<dd><p><em>u.Scalar[momentum]</em> &#8211; x, y, and z of <code class="docutils literal"><span class="pre">atom.momentum</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">fx, fy, fz</code></dt>
<dd><p><em>u.Scalar[force]</em> &#8211; x, y, and z <code class="docutils literal"><span class="pre">atom.force</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.residue">
<code class="descname">residue</code><a class="headerlink" href="#moldesign.molecules.Atom.residue" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Residue</em> &#8211; biomolecular residue that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.Atom.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Chain</em> &#8211; biomolecular chain that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.Atom.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Molecule</em> &#8211; molecule that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">index</code></dt>
<dd><p><em>int</em> &#8211; index in the parent molecule: <code class="docutils literal"><span class="pre">atom</span> <span class="pre">is</span> <span class="pre">atom.parent.atoms[index]</span></code></p>
</dd></dl>

<p><strong>Atom methods and properties</strong></p>
<p>See also methods offered by the mixin superclasses:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-class docutils literal"><span class="pre">AtomDrawingMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">AtomGeometryMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">AtomPropertyMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">AtomReprMixin</span></code></li>
</ul>
</div></blockquote>
<dl class="attribute">
<dt id="moldesign.molecules.Atom.bond_graph">
<code class="descname">bond_graph</code><a class="headerlink" href="#moldesign.molecules.Atom.bond_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Mapping[Atom, int]</em> &#8211; dictionary of this atoms bonded neighbors, of the form
<code class="docutils literal"><span class="pre">{bonded_atom1,</span> <span class="pre">bond_order1,</span> <span class="pre">...}</span></code></p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Atom.bond_to">
<code class="descname">bond_to</code><span class="sig-paren">(</span><em>other</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#Atom.bond_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Atom.bond_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Create or modify a bond with another atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; atom to bond to</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; bond order</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bond object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#moldesign.molecules.bonds.Bond" title="moldesign.molecules.bonds.Bond">moldesign.molecules.bonds.Bond</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#moldesign.molecules.Atom.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Bond]</em> &#8211; list of all bonds this atom is involved in</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Atom.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.Atom.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.elem">
<code class="descname">elem</code><a class="headerlink" href="#moldesign.molecules.Atom.elem" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">element</code></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.force">
<code class="descname">force</code><a class="headerlink" href="#moldesign.molecules.Atom.force" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(units.Vector[force])</em> &#8211; atomic force vector. This quantity must be calculated - it is
equivalent to <code class="docutils literal"><span class="pre">self.molecule.forces[self.index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">moldesign.NotCalculatedError</span></code> &#8211; if molecular forces have not been calculated</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.heavy_bonds">
<code class="descname">heavy_bonds</code><a class="headerlink" href="#moldesign.molecules.Atom.heavy_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Bond]</em> &#8211; list of all heavy atom bonds (where BOTH atoms are not hydrogen)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this returns an empty list if called on a hydrogen atom</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.num_bonds">
<code class="descname">num_bonds</code><a class="headerlink" href="#moldesign.molecules.Atom.num_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; the number of other atoms this atom is bonded to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.symbol">
<code class="descname">symbol</code><a class="headerlink" href="#moldesign.molecules.Atom.symbol" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Atom.velocity">
<code class="descname">velocity</code><a class="headerlink" href="#moldesign.molecules.Atom.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Vector[length/time, 3]</em> &#8211; velocity of this atom; equivalent to
<code class="docutils literal"><span class="pre">self.momentum/self.mass</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Entity">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Entity</code><span class="sig-paren">(</span><em>name=None</em>, <em>molecule=None</em>, <em>index=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a>, <a class="reference internal" href="moldesign.utils.html#moldesign.utils.classes.DictLike" title="moldesign.utils.classes.DictLike"><code class="xref py py-class docutils literal"><span class="pre">moldesign.utils.classes.DictLike</span></code></a></p>
<p>Generalized storage mechanism for hierarchical representation of biomolecules,
e.g. by residue, chain, etc. Permits other groupings, provided that everything is
tree-like.</p>
<p>All children of a given entity must have unique keys. An individual child can be retrieved with
<code class="docutils literal"><span class="pre">entity.childname</span></code> or <code class="docutils literal"><span class="pre">entity['childname']</span></code> or <code class="docutils literal"><span class="pre">entity[index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Entity or mdt.Atom</em> &#8211; this entity&#8217;s children, in order</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="moldesign.molecules.Entity.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>item</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Entity.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a child to this entity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an object with this key already exists</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>item</strong> (<em>Entity or mdt.Atom</em>) &#8211; the child object to add</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Key to retrieve this item (default: <code class="docutils literal"><span class="pre">item.name</span></code> )</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.Entity.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; a sorted list of all atoms in this entity and/or its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.indexlist">
<code class="descname">indexlist</code><a class="headerlink" href="#moldesign.molecules.Entity.indexlist" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> &#8211; list of all children, in order</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Entity.iteratoms">
<code class="descname">iteratoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity.iteratoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Entity.iteratoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all atoms (i.e. leaf nodes)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Atom</em> &#8211; all atoms in this entity and/or its children</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.mass">
<code class="descname">mass</code><a class="headerlink" href="#moldesign.molecules.Entity.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[mass]</em> &#8211; total mass of this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.natoms">
<code class="descname">natoms</code><a class="headerlink" href="#moldesign.molecules.Entity.natoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.num_atoms">
<code class="descname">num_atoms</code><a class="headerlink" href="#moldesign.molecules.Entity.num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Entity.numatoms">
<code class="descname">numatoms</code><a class="headerlink" href="#moldesign.molecules.Entity.numatoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Instance">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Instance</code><span class="sig-paren">(</span><em>name=None</em>, <em>molecule=None</em>, <em>index=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>The singleton biomolecular container for each <code class="docutils literal"><span class="pre">Molecule</span></code>. Its children are generally
PDB chains. Users won&#8217;t ever really see this object.</p>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Residue">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>A biomolecular residue - most often an amino acid, a nucleic base, or a solvent
molecule. In PDB structures, also often refers to non-biochemical molecules.</p>
<p>Its children are almost always residues.</p>
<dl class="attribute">
<dt id="moldesign.molecules.Residue.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.Residue.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.Molecule</em> &#8211; the molecule this residue belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.Residue.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; the chain this residue belongs to</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Residue.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>atom</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Residue.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized storage mechanism for hierarchical representation of biomolecules,
e.g. by residue, chain, etc. Permits other groupings, provided that everything is
tree-like.</p>
<p>All children of a given entity must have unique keys. An individual child can be retrieved with
<code class="docutils literal"><span class="pre">entity.childname</span></code> or <code class="docutils literal"><span class="pre">entity['childname']</span></code> or <code class="docutils literal"><span class="pre">entity[index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Entity or mdt.Atom</em> &#8211; this entity&#8217;s children, in order</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Residue.assign_template_bonds">
<code class="descname">assign_template_bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.assign_template_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Residue.assign_template_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign bonds from bioresidue templates.</p>
<p>Only assigns bonds that are internal to this residue (does not connect different residues).
The topologies here assume pH7.4 and may need to be corrected for other pHs</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><span class="xref std std-ref">moldesign.Chain.assign_biopolymer_bonds</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if <code class="docutils literal"><span class="pre">residue.resname</span></code> is not in bioresidue templates</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an atom in this residue is not recognized</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.atomnames">
<code class="descname">atomnames</code><a class="headerlink" href="#moldesign.molecules.Residue.atomnames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Residue</em> &#8211; synonym for <code class="docutils literal"><span class="pre">`self`</span></code> for for the sake of readability &#8211; <code class="docutils literal"><span class="pre">`molecule.chains['A'].residues[123].atomnames['CA']`</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.backbone">
<code class="descname">backbone</code><a class="headerlink" href="#moldesign.molecules.Residue.backbone" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; all backbone atoms for nucleic and protein residues
(indentified using PDB names); returns None for other residue types</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.code">
<code class="descname">code</code><a class="headerlink" href="#moldesign.molecules.Residue.code" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; one-letter amino acid code or two letter nucleic acid code, or &#8216;?&#8217; otherwise</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Residue.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Residue.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.is_3prime_end">
<code class="descname">is_3prime_end</code><a class="headerlink" href="#moldesign.molecules.Residue.is_3prime_end" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the last base in a strand</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not a DNA base</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.is_5prime_end">
<code class="descname">is_5prime_end</code><a class="headerlink" href="#moldesign.molecules.Residue.is_5prime_end" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the first base in a strand</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not a DNA base</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.is_c_terminal">
<code class="descname">is_c_terminal</code><a class="headerlink" href="#moldesign.molecules.Residue.is_c_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the first residue in a peptide</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not an amino acid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.is_monomer">
<code class="descname">is_monomer</code><a class="headerlink" href="#moldesign.molecules.Residue.is_monomer" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this residue is not part of a biopolymer</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.is_n_terminal">
<code class="descname">is_n_terminal</code><a class="headerlink" href="#moldesign.molecules.Residue.is_n_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the last residue in a peptide</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not an amino acid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Residue.markdown_summary">
<code class="descname">markdown_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.markdown_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Residue.markdown_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Markdown-formatted information about this residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">markdown-formatted string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.next_residue">
<code class="descname">next_residue</code><a class="headerlink" href="#moldesign.molecules.Residue.next_residue" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt><em>Residue</em> &#8211;     The next residue in the chain (in the C-direction for proteins, 3&#8217;</dt>
<dd>direction for nucleic acids)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code> &#8211; If we don&#8217;t know how to deal with this type of biopolymer</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></code> &#8211; If there isn&#8217;t a next residue (i.e. it&#8217;s a 3&#8217;- or C-terminus)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.prev_residue">
<code class="descname">prev_residue</code><a class="headerlink" href="#moldesign.molecules.Residue.prev_residue" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Residue</em> &#8211;     The next residue in the chain (in the N-direction for proteins, 5&#8217; direction for nucleic acids)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code> &#8211; If we don&#8217;t know how to deal with this type of biopolymer</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></code> &#8211; If there isn&#8217;t a previous residue (i.e. it&#8217;s a 5&#8217;- or N-terminus)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.resname">
<code class="descname">resname</code><a class="headerlink" href="#moldesign.molecules.Residue.resname" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; Synonym for pdbname</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.sidechain">
<code class="descname">sidechain</code><a class="headerlink" href="#moldesign.molecules.Residue.sidechain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; all sidechain atoms for nucleic and protein residues
(defined as non-backbone atoms); returns None for other residue types</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Residue.type">
<code class="descname">type</code><a class="headerlink" href="#moldesign.molecules.Residue.type" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; Classification of the residue (protein, solvent, dna, water, unknown)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Chain">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Chain</code><span class="sig-paren">(</span><em>pdbname=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>Biomolecular chain class - its children are almost always residues.</p>
<dl class="attribute">
<dt id="moldesign.molecules.Chain.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.Chain.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.Molecule</em> &#8211; the molecule this residue belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Chain.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.Chain.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; the chain this residue belongs to</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Chain.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>residue</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Chain.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Chain.assign_biopolymer_bonds">
<code class="descname">assign_biopolymer_bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.assign_biopolymer_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Chain.assign_biopolymer_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect bonds between residues in this chain. Does not .</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><span class="xref std std-ref">moldesign.Residue.assign_template_bonds</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if <code class="docutils literal"><span class="pre">residue.resname</span></code> is not in bioresidue templates</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an atom in this residue is not recognized</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Chain.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Chain.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Chain.residues">
<code class="descname">residues</code><a class="headerlink" href="#moldesign.molecules.Chain.residues" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; synonym for &#8216;self&#8217; to enhance readability,
e.g. <code class="docutils literal"><span class="pre">`molecule.chains['A'].residue[123]`</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Chain.sequence">
<code class="descname">sequence</code><a class="headerlink" href="#moldesign.molecules.Chain.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; this chain&#8217;s residue sequence with one-letter residue codes</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.MolecularProperties">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">MolecularProperties</code><span class="sig-paren">(</span><em>mol</em>, <em>**properties</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolecularProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.MolecularProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="moldesign.utils.html#moldesign.utils.classes.DotDict" title="moldesign.utils.classes.DotDict"><code class="xref py py-class docutils literal"><span class="pre">moldesign.utils.classes.DotDict</span></code></a></p>
<p>Stores property values for a molecule.
These objects will be generally created and updated by EnergyModels, not by users.</p>
<dl class="method">
<dt id="moldesign.molecules.MolecularProperties.geometry_matches">
<code class="descname">geometry_matches</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolecularProperties.geometry_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.MolecularProperties.geometry_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
bool: True if the molecule&#8217;s <code class="docutils literal"><span class="pre">position</span></code> is the same as these properties&#8217; <code class="docutils literal"><span class="pre">position</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Molecule">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Molecule</code><span class="sig-paren">(</span><em>atomcontainer</em>, <em>name=None</em>, <em>bond_graph=None</em>, <em>copy_atoms=False</em>, <em>pdbname=None</em>, <em>charge=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolConstraintMixin" title="moldesign.molecules.molecule.MolConstraintMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolConstraintMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolPropertyMixin" title="moldesign.molecules.molecule.MolPropertyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolPropertyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolDrawingMixin" title="moldesign.molecules.molecule.MolDrawingMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolDrawingMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolReprMixin" title="moldesign.molecules.molecule.MolReprMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolReprMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolTopologyMixin" title="moldesign.molecules.molecule.MolTopologyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolTopologyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolSimulationMixin" title="moldesign.molecules.molecule.MolSimulationMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolSimulationMixin</span></code></a></p>
<p><code class="docutils literal"><span class="pre">Molecule</span></code> objects store a molecular system, including atoms, 3D coordinates, molecular
properties, biomolecular entities, and other model-specific information. Interfaces with
simulation models take place through the molecule object.</p>
<p>Molecule objects will generally be created by reading files or parsing other input; see, for
example: <a class="reference internal" href="../toplevel.html#moldesign.read" title="moldesign.read"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.read()</span></code></a>, <a class="reference internal" href="../toplevel.html#moldesign.from_smiles" title="moldesign.from_smiles"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.from_smiles()</span></code></a>,
<a class="reference internal" href="../toplevel.html#moldesign.from_pdb" title="moldesign.from_pdb"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.from_pdb()</span></code></a>, etc.</p>
<p>This constructor is useful, however for copying other molecular structures (see
examples below).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atomcontainer</strong> (<em>AtomContainer or AtomList or List[moldesign.Atom]</em>) &#8211; <p>atoms that make up
this molecule.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the passed atoms don&#8217;t already belong to a molecule, they will be assigned
to this one. If they DO already belong to a molecule, they will be copied,
leaving the original molecule untouched.</p>
</div>
</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the molecule (automatically generated if not provided)</li>
<li><strong>bond_graph</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dictionary specifying bonds between the atoms - of the form
<code class="docutils literal"><span class="pre">{atom1:{atom2:bond_order,</span> <span class="pre">atom3:bond_order},</span> <span class="pre">atom2:...}</span></code>
This structure must be symmetric; we require
<code class="docutils literal"><span class="pre">bond_graph[atom1][atom2]</span> <span class="pre">==</span> <span class="pre">bond_graph[atom2][atom1]</span></code></li>
<li><strong>copy_atoms</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create the molecule with <em>copies</em> of the passed atoms
(they will be copied automatically if they already belong to another molecule)</li>
<li><strong>pdbname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the PDB file</li>
<li><strong>charge</strong> (<em>units.Scalar[charge]</em>) &#8211; molecule&#8217;s formal charge</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Use the <code class="docutils literal"><span class="pre">Molecule</span></code> class to create copies of other molecules and substructures thereof:
&gt;&gt;&gt; benzene = mdt.from_name(&#8216;benzene&#8217;)
&gt;&gt;&gt; benzene_copy = mdt.Molecule(benzene, name=&#8217;benzene copy&#8217;)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">protein</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">from_pdb</span><span class="p">(</span><span class="s1">&#39;3AID&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">carbon_copies</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">Molecule</span><span class="p">([</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">atnum</span><span class="o">==</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_residue_copy</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Molecule instance attributes:</strong></p>
<dl class="attribute">
<dt id="moldesign.molecules.Molecule.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.Molecule.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; List of all atoms in this molecule.</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.bond_graph">
<code class="descname">bond_graph</code><a class="headerlink" href="#moldesign.molecules.Molecule.bond_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> &#8211; symmetric dictionary specifying bonds between the
atoms:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">bond_graph</span> <span class="pre">=</span> <span class="pre">{atom1:{atom2:bond_order,</span> <span class="pre">atom3:bond_order},</span> <span class="pre">atom2:...}</span></code></p>
<p><code class="docutils literal"><span class="pre">bond_graph[atom1][atom2]</span> <span class="pre">==</span> <span class="pre">bond_graph[atom2][atom1]</span></code></p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.residues">
<code class="descname">residues</code><a class="headerlink" href="#moldesign.molecules.Molecule.residues" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[moldesign.Residue]</em> &#8211; flat list of all biomolecular residues in this molecule</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.chains">
<code class="descname">chains</code><a class="headerlink" href="#moldesign.molecules.Molecule.chains" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Dict[moldesign.Chain]</em> &#8211; Biomolecular chains - individual chains can be
accessed as <code class="docutils literal"><span class="pre">mol.chains[list_index]</span></code> or <code class="docutils literal"><span class="pre">mol.chains[chain_name]</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.Molecule.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; A descriptive name for molecule</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.charge">
<code class="descname">charge</code><a class="headerlink" href="#moldesign.molecules.Molecule.charge" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Scalar[charge]</em> &#8211; molecule&#8217;s formal charge</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.ndims">
<code class="descname">ndims</code><a class="headerlink" href="#moldesign.molecules.Molecule.ndims" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; length of the positions, momenta, and forces arrays (usually 3*self.num_atoms)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.num_atoms">
<code class="descname">num_atoms</code><a class="headerlink" href="#moldesign.molecules.Molecule.num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms (synonyms: num_atoms, numatoms)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.positions">
<code class="descname">positions</code><a class="headerlink" href="#moldesign.molecules.Molecule.positions" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[length]</em> &#8211; Nx3 array of atomic positions</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.momenta">
<code class="descname">momenta</code><a class="headerlink" href="#moldesign.molecules.Molecule.momenta" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[momentum]</em> &#8211; Nx3 array of atomic momenta</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.masses">
<code class="descname">masses</code><a class="headerlink" href="#moldesign.molecules.Molecule.masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[mass]</em> &#8211; vector of atomic masses</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.dim_masses">
<code class="descname">dim_masses</code><a class="headerlink" href="#moldesign.molecules.Molecule.dim_masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[mass]</em> &#8211; Nx3 array of atomic masses (for numerical convenience -
allows you to calculate velocity, for instance, as
<code class="docutils literal"><span class="pre">velocity</span> <span class="pre">=</span> <span class="pre">mol.momenta/mol.dim_masses</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.time">
<code class="descname">time</code><a class="headerlink" href="#moldesign.molecules.Molecule.time" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Scalar[time]</em> &#8211; current time in dynamics</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.energy_model">
<code class="descname">energy_model</code><a class="headerlink" href="#moldesign.molecules.Molecule.energy_model" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.models.base.EnergyModelBase</em> &#8211; Object that calculates
molecular properties - driven by <cite>mol.calculate()</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.integrator">
<code class="descname">integrator</code><a class="headerlink" href="#moldesign.molecules.Molecule.integrator" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.integrators.base.IntegratorBase</em> &#8211; Object that drives movement of 3D
coordinates in time, driven by mol.run()</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.is_biomolecule">
<code class="descname">is_biomolecule</code><a class="headerlink" href="#moldesign.molecules.Molecule.is_biomolecule" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; True if this molecule contains at least 2 biochemical residues</p>
</dd></dl>

<p><strong>Molecule methods and properties</strong></p>
<p>See also methods offered by the mixin superclasses:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.AtomContainer</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolPropertyMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolDrawingMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolSimulationMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolTopologyMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolConstraintMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolReprMixin</span></code></li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="moldesign.molecules.Molecule.addatom">
<code class="descname">addatom</code><span class="sig-paren">(</span><em>newatom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.addatom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule.addatom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new atom to the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>newatom</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; The atom to add
(it will be copied if it already belongs to a molecule)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Molecule.addatoms">
<code class="descname">addatoms</code><span class="sig-paren">(</span><em>newatoms</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.addatoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule.addatoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new atoms to this molecule.
For now, we really just rebuild the entire molecule in place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>newatoms</strong> (<em>List[moldesign.Atom]</em>) &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#moldesign.molecules.Molecule.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over all bonds in the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>moldesign.atoms.Bond</em> &#8211; bond object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Molecule.deletebond">
<code class="descname">deletebond</code><span class="sig-paren">(</span><em>bond</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.deletebond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule.deletebond" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove this bond from the molecule&#8217;s topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>Bond</strong> &#8211; bond to remove</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.is_small_molecule">
<code class="descname">is_small_molecule</code><a class="headerlink" href="#moldesign.molecules.Molecule.is_small_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; True if molecule&#8217;s mass is less than 500 Daltons (not mutually exclusive with
<a class="reference internal" href="#moldesign.molecules.Molecule.is_biomolecule" title="moldesign.molecules.Molecule.is_biomolecule"><code class="xref py py-meth docutils literal"><span class="pre">self.is_biomolecule</span></code></a>)</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Molecule.newbond">
<code class="descname">newbond</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.newbond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule.newbond" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new bond</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a1</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; First atom in the bond</li>
<li><strong>a2</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; Second atom in the bond</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; order of the bond</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">moldesign.Bond</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Molecule.velocities">
<code class="descname">velocities</code><a class="headerlink" href="#moldesign.molecules.Molecule.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Vector[length/time]</em> &#8211; Nx3 array of atomic velocities</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Molecule.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Molecule.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write this molecule to a string or file.</p>
<p>This is a convenience method for <span class="xref std std-ref">moldesign.converters.write</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; filename to write (if not passed, write to string)</li>
<li><strong>format</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; file format (if filename is not passed, format must be specified)
Guessed from file extension if not passed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.Trajectory">
<em class="property">class </em><code class="descclassname">moldesign.molecules.</code><code class="descname">Trajectory</code><span class="sig-paren">(</span><em>mol</em>, <em>unit_system=None</em>, <em>first_frame=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A <code class="docutils literal"><span class="pre">Trajectory</span></code> stores information about a molecule&#8217;s motion and how its properties
change as it moves.</p>
<dl class="docutils">
<dt>A trajectory object contains</dt>
<dd><ol class="first last arabic simple">
<li>a reference to the <a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><code class="xref py py-class docutils literal"><span class="pre">moldesign.Molecule</span></code></a> it describes, and</li>
<li>a list of <code class="xref py py-class docutils literal"><span class="pre">Frame</span></code> objects, each one containing a snapshot of the molecule at a</li>
</ol>
</dd>
</dl>
<p>particular point in its motion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><em>moldesign.Molecule</em></a>) &#8211; the trajectory will describe the motion of this molecule</li>
<li><strong>unit_system</strong> (<em>u.UnitSystem</em>) &#8211; convert all attributes to this unit system (default:
<code class="docutils literal"><span class="pre">moldesign.units.default</span></code>)</li>
<li><strong>first_frame</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create the trajectory&#8217;s first <code class="xref py py-class docutils literal"><span class="pre">Frame</span></code> from the molecule&#8217;s
current position</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.mol">
<code class="descname">mol</code><a class="headerlink" href="#moldesign.molecules.Trajectory.mol" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Molecule</em> &#8211; the molecule object that this trajectory comes from</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.frames">
<code class="descname">frames</code><a class="headerlink" href="#moldesign.molecules.Trajectory.frames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Frame]</em> &#8211; a list of the trajectory frames in the order they were created</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.info">
<code class="descname">info</code><a class="headerlink" href="#moldesign.molecules.Trajectory.info" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; text describing this trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.unit_system">
<code class="descname">unit_system</code><a class="headerlink" href="#moldesign.molecules.Trajectory.unit_system" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.UnitSystem</em> &#8211; convert all attributes to this unit system</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.DONOTAPPLY">
<code class="descname">DONOTAPPLY</code><em class="property"> = set(['kinetic_energy'])</em><a class="headerlink" href="#moldesign.molecules.Trajectory.DONOTAPPLY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.MOL_ATTRIBUTES">
<code class="descname">MOL_ATTRIBUTES</code><em class="property"> = ['positions', 'momenta', 'time']</em><a class="headerlink" href="#moldesign.molecules.Trajectory.MOL_ATTRIBUTES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.align_orbital_phases">
<code class="descname">align_orbital_phases</code><span class="sig-paren">(</span><em>reference_frame=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.align_orbital_phases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.align_orbital_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to remove orbital sign flips between frames.
If <cite>reference_frame</cite> is not passed, we&#8217;ll start with frame 0 and
align successive pairs of orbitals.
If <cite>reference_frame</cite> is an int, we&#8217;ll move forwards and backwards from that frame number.
Otherwise, we&#8217;ll try to align every orbital frame to those in reference_frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reference_frame</strong> (<em>int or Frame</em>) &#8211; <code class="docutils literal"><span class="pre">Frame</span></code> containing the orbitals to align with
(default: align each frame with the previous one)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.apply_frame">
<code class="descname">apply_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.apply_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.apply_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct the underlying molecule with the given frame.
Right now, any data not passed is ignored, which may result in properties that aren&#8217;t synced up
with each other ...</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.Trajectory.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.draw3d">
<code class="descname">draw3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.draw3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.draw3d" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.draw_orbitals">
<code class="descname">draw_orbitals</code><span class="sig-paren">(</span><em>align=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.draw_orbitals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.draw_orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryOrbViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.kinetic_energy">
<code class="descname">kinetic_energy</code><a class="headerlink" href="#moldesign.molecules.Trajectory.kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.kinetic_temperature">
<code class="descname">kinetic_temperature</code><a class="headerlink" href="#moldesign.molecules.Trajectory.kinetic_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.new_frame">
<code class="descname">new_frame</code><span class="sig-paren">(</span><em>properties=None</em>, <em>**additional_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.new_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.new_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new frame, EITHER from the parent molecule or from a list of properties</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dictionary of properties (i.e. {&#8216;positions&#8217;:[...],</li>
<li><strong>'potential_energy'</strong> &#8211; ...})</li>
<li><strong>**additional_data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; any additional data to be added to the trajectory frame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">frame number (0-based)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.Trajectory.num_frames">
<code class="descname">num_frames</code><a class="headerlink" href="#moldesign.molecules.Trajectory.num_frames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of frames in this trajectory</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a matplotlib plot of property x against property y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x,y</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; names of the properties</li>
<li><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; kwargs for <code class="xref py py-meth docutils literal"><span class="pre">matplotlib.pylab.plot()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the lines that were plotted</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List[matplotlib.lines.Lines2D]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.rmsd">
<code class="descname">rmsd</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>reference=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate root-mean-square displacement for each frame in the trajectory.</p>
<p>The RMSD between times <span class="math">\(t\)</span> and <span class="math">\(t0\)</span> is given by</p>
<p><span class="math">\(\text{RMSD}(t;t_0) =\sqrt{\sum_{i \in \text{atoms}} \left( \mathbf{R}_i(t) -
\mathbf{R}_i(t_0) \right)^2}\)</span>,</p>
<p>where <span class="math">\(\mathbf{R}_i(t)\)</span> is the position of atom <em>i</em> at time <em>t</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list[mdt.Atom]</em>) &#8211; list of atoms to calculate the RMSD for (all atoms in the
<code class="docutils literal"><span class="pre">Molecule</span></code>)</li>
<li><strong>reference</strong> (<em>u.Vector[length]</em>) &#8211; Reference positions for RMSD. (default:
<code class="docutils literal"><span class="pre">traj.frames[0].positions</span></code>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of RMSD displacements for each frame in the trajectory</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">u.Vector[length]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.slice_frames">
<code class="descname">slice_frames</code><span class="sig-paren">(</span><em>key</em>, <em>missing=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.slice_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.slice_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of giving the value of <code class="docutils literal"><span class="pre">key</span></code> at each frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the property, e.g., time, potential_energy, annotation, etc</li>
<li><strong>missing</strong> &#8211; value to return if a given frame does not have this property</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>vector containing the value at each frame, or the value given</dt>
<dd><p class="first last">in the <code class="docutils literal"><span class="pre">missing</span></code> keyword) (len= <cite>len(self)</cite> )</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.units.Vector</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.Trajectory.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.Trajectory.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-moldesign.molecules.atomcollections">
<span id="moldesign-molecules-atomcollections-module"></span><h2>moldesign.molecules.atomcollections module<a class="headerlink" href="#module-moldesign.molecules.atomcollections" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="moldesign.molecules.atomcollections.AtomContainer">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atomcollections.</code><code class="descname">AtomContainer</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mixin functions for objects that have a <code class="docutils literal"><span class="pre">self.atoms</span></code> attribute with a list of atoms</p>
<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Atom]</em> &#8211; a list of atoms</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.atoms_within">
<code class="descname">atoms_within</code><span class="sig-paren">(</span><em>radius</em>, <em>other=None</em>, <em>include_self=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.atoms_within"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.atoms_within" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all atoms in an object within a given radius of this object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>radius</strong> (<em>u.Scalar[length]</em>) &#8211; radius to search for atoms</li>
<li><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><em>AtomContainer</em></a>) &#8211; object containing the atoms to search (default:self.parent)</li>
<li><strong>include_self</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; if True, include the atoms from this object (since, by definition,
their distance from this object is 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of the atoms within <code class="docutils literal"><span class="pre">radius</span></code> of this object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.calc_displacements">
<code class="descname">calc_displacements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.calc_displacements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.calc_displacements" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an array of displacements between all atoms in this object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">array of pairwise displacements between atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">u.Array[length]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">displacements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_displacements</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">displacements</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.calc_distance_array">
<code class="descname">calc_distance_array</code><span class="sig-paren">(</span><em>other=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.calc_distance_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.calc_distance_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an array of pairwise distance between all atoms in self and other</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><em>AtomContainer</em></a>) &#8211; object to calculate distances to (default: self)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">2D array of pairwise distances between the two objects</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">u.Array[length]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_distance_array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.center_of_mass">
<code class="descname">center_of_mass</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[length]</em> &#8211; The (x,y,z) coordinates of this object&#8217;s center of mass</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.com">
<code class="descname">com</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.com" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[length]</em> &#8211; The (x,y,z) coordinates of this object&#8217;s center of mass</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.distance">
<code class="descname">distance</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns closest distance between this and the other entity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><em>AtomContainer</em></a>) &#8211; object to calculate distance to</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">closest distance between self and other</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">u.Scalar[length]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_distance_array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>width=500</em>, <em>height=500</em>, <em>show_2dhydrogens=None</em>, <em>display=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize this molecule (Jupyter only).</p>
<p>Creates a 3D viewer, and, for small molecules, a 2D viewer).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; width of the viewer in pixels</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; height of the viewer in pixels</li>
<li><strong>show_2dhydrogens</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; whether to show the hydrogens in 2d (default: True if there
are 10 or less heavy atoms, false otherwise)</li>
<li><strong>display</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; immediately display this viewer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">moldesign.ui.SelectionGroup</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.draw2d">
<code class="descname">draw2d</code><span class="sig-paren">(</span><em>highlight_atoms=None</em>, <em>show_hydrogens=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.draw2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.draw2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw this object in 2D. Jupyter only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>highlight_atoms</strong> (<em>List[Atom]</em>) &#8211; atoms to highlight when the structure is drawn</li>
<li><strong>show_hydrogens</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; whether to draw the hydrogens or not (default: True if there
are 10 or less heavy atoms, false otherwise)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2D viewer object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">mdt.ChemicalGraphViewer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.draw3d">
<code class="descname">draw3d</code><span class="sig-paren">(</span><em>highlight_atoms=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.draw3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.draw3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw this object in 3D. Jupyter only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>highlight_atoms</strong> (<em>List[Atom]</em>) &#8211; atoms to highlight when the structure is drawn</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">3D viewer object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mdt.GeometryViewer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.get_atoms">
<code class="descname">get_atoms</code><span class="sig-paren">(</span><em>**queries</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.get_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.get_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows keyword-based atom queries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**queries</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; parameters to match</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the atoms matching this query</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.heavy_atoms">
<code class="descname">heavy_atoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.heavy_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; a list of all heavy atoms (i.e., non-hydrogen) in this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.natoms">
<code class="descname">natoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.natoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms in this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.num_atoms">
<code class="descname">num_atoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms in this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.numatoms">
<code class="descname">numatoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.numatoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms in this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomContainer.positions">
<code class="descname">positions</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.positions" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Array[length]</em> &#8211; (Nx3) array of atomic positions</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>angle</em>, <em>axis</em>, <em>center=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate this object in 3D space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>angle</strong> (<em>u.Scalar[angle]</em>) &#8211; angle to rotate by</li>
<li><strong>axis</strong> (<em>u.Vector[length]</em>) &#8211; axis to rotate about (len=3)</li>
<li><strong>center</strong> (<em>u.Vector[length]</em>) &#8211; center of rotation (len=3) (default: origin)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform this object&#8217;s coordinates using the provided 4x4 matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>numpy.ndarray</em>) &#8211; transformation matrix, shape=(4,4)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atomcollections.AtomContainer.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomContainer.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomContainer.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate this object in 3D space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector</strong> (<em>u.Vector[length]</em>) &#8211; translation vector, len=3</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.atomcollections.AtomList">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atomcollections.</code><code class="descname">AtomList</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atomcollections.html#AtomList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">list</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a></p>
<p>A list of atoms that allows attribute &#8220;slicing&#8221; - accessing an attribute of the
list will return a list of atom attributes.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atomlist</span><span class="o">.</span><span class="n">mass</span> <span class="o">==</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atomlist</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">getattr</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atomlist</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="moldesign.molecules.atomcollections.AtomList.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.atomcollections.AtomList.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a synonym for self so that AtomContainer methods will work here too</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="moldesign-molecules-atoms-module">
<h2>moldesign.molecules.atoms module<a class="headerlink" href="#moldesign-molecules-atoms-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-moldesign.molecules.atoms"></span><dl class="class">
<dt id="moldesign.molecules.atoms.Atom">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atoms.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>name=None</em>, <em>atnum=None</em>, <em>mass=None</em>, <em>chain=None</em>, <em>residue=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>element=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atoms.AtomDrawingMixin" title="moldesign.molecules.atoms.AtomDrawingMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomDrawingMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomGeometryMixin" title="moldesign.molecules.atoms.AtomGeometryMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomGeometryMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomPropertyMixin" title="moldesign.molecules.atoms.AtomPropertyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomPropertyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.atoms.AtomReprMixin" title="moldesign.molecules.atoms.AtomReprMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atoms.AtomReprMixin</span></code></a></p>
<p>A data structure representing an atom.</p>
<p><code class="docutils literal"><span class="pre">Atom</span></code> objects store information about individual atoms within a larger molecular system,
providing access to atom-specific geometric, biomolecular, topological and property
information. Each <a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> is composed of a list of atoms.</p>
<p>Atoms can be instantiated directly, but they will generally be created
automatically as part of molecules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The atom&#8217;s name (if not passed, set to the element name + the atom&#8217;s index)</li>
<li><strong>atnum</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Atomic number (if not passed, determined from element if possible)</li>
<li><strong>mass</strong> (<em>units.Scalar[mass]</em>) &#8211; The atomic mass (if not passed, set to the most abundant isotopic
mass)</li>
<li><strong>chain</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Chain" title="moldesign.Chain"><em>moldesign.Chain</em></a>) &#8211; biomolecular chain that this atom belongs to</li>
<li><strong>residue</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Residue" title="moldesign.Residue"><em>moldesign.Residue</em></a>) &#8211; biomolecular residue that this atom belongs to</li>
<li><strong>pdbname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name from PDB entry, if applicable</li>
<li><strong>pdbindex</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; atom serial number in the PDB entry, if applicable</li>
<li><strong>element</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Elemental symbol (if not passed, determined from atnum if possible)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Atom instance attributes:</strong></p>
<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; A descriptive name for this atom</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.element">
<code class="descname">element</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.element" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; IUPAC elemental symbol (&#8216;C&#8217;, &#8216;H&#8217;, &#8216;Cl&#8217;, etc.)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.index">
<code class="descname">index</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.index" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; the atom&#8217;s current index in the molecule
(<code class="docutils literal"><span class="pre">self</span> <span class="pre">is</span> <span class="pre">self.parent.atoms[</span> <span class="pre">self.index]</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.atnum">
<code class="descname">atnum</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.atnum" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; atomic number (synonyms: atomic_num)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.mass">
<code class="descname">mass</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[mass]</em> &#8211; the atom&#8217;s mass</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.position">
<code class="descname">position</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.position" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[length]</em> &#8211; atomic position vector. Once an atom is part of a molecule,
this quantity will refer to <code class="docutils literal"><span class="pre">self.molecule.positions[self.index]</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.momentum">
<code class="descname">momentum</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[momentum]</em> &#8211; atomic momentum vector. Once an atom is part of a
molecule, this quantity will refer to <code class="docutils literal"><span class="pre">self.molecule.momenta[self.index]</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">x,y,z</code></dt>
<dd><p><em>u.Scalar[length]</em> &#8211; x, y, and z components of <code class="docutils literal"><span class="pre">atom.position</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">vx, vy, vz</code></dt>
<dd><p><em>u.Scalar[length/time]</em> &#8211; x, y, of <code class="docutils literal"><span class="pre">atom.velocity</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">px, py, pz</code></dt>
<dd><p><em>u.Scalar[momentum]</em> &#8211; x, y, and z of <code class="docutils literal"><span class="pre">atom.momentum</span></code></p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">fx, fy, fz</code></dt>
<dd><p><em>u.Scalar[force]</em> &#8211; x, y, and z <code class="docutils literal"><span class="pre">atom.force</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.residue">
<code class="descname">residue</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.residue" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Residue</em> &#8211; biomolecular residue that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Chain</em> &#8211; biomolecular chain that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Molecule</em> &#8211; molecule that this atom belongs to</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">index</code></dt>
<dd><p><em>int</em> &#8211; index in the parent molecule: <code class="docutils literal"><span class="pre">atom</span> <span class="pre">is</span> <span class="pre">atom.parent.atoms[index]</span></code></p>
</dd></dl>

<p><strong>Atom methods and properties</strong></p>
<p>See also methods offered by the mixin superclasses:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#moldesign.molecules.atoms.AtomDrawingMixin" title="moldesign.molecules.atoms.AtomDrawingMixin"><code class="xref py py-class docutils literal"><span class="pre">AtomDrawingMixin</span></code></a></li>
<li><a class="reference internal" href="#moldesign.molecules.atoms.AtomGeometryMixin" title="moldesign.molecules.atoms.AtomGeometryMixin"><code class="xref py py-class docutils literal"><span class="pre">AtomGeometryMixin</span></code></a></li>
<li><a class="reference internal" href="#moldesign.molecules.atoms.AtomPropertyMixin" title="moldesign.molecules.atoms.AtomPropertyMixin"><code class="xref py py-class docutils literal"><span class="pre">AtomPropertyMixin</span></code></a></li>
<li><a class="reference internal" href="#moldesign.molecules.atoms.AtomReprMixin" title="moldesign.molecules.atoms.AtomReprMixin"><code class="xref py py-class docutils literal"><span class="pre">AtomReprMixin</span></code></a></li>
</ul>
</div></blockquote>
<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.bond_graph">
<code class="descname">bond_graph</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.bond_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Mapping[Atom, int]</em> &#8211; dictionary of this atoms bonded neighbors, of the form
<code class="docutils literal"><span class="pre">{bonded_atom1,</span> <span class="pre">bond_order1,</span> <span class="pre">...}</span></code></p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.Atom.bond_to">
<code class="descname">bond_to</code><span class="sig-paren">(</span><em>other</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#Atom.bond_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.Atom.bond_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Create or modify a bond with another atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; atom to bond to</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; bond order</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bond object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#moldesign.molecules.bonds.Bond" title="moldesign.molecules.bonds.Bond">moldesign.molecules.bonds.Bond</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Bond]</em> &#8211; list of all bonds this atom is involved in</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.Atom.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.atoms.Atom.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.elem">
<code class="descname">elem</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.elem" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">element</code></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.force">
<code class="descname">force</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.force" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(units.Vector[force])</em> &#8211; atomic force vector. This quantity must be calculated - it is
equivalent to <code class="docutils literal"><span class="pre">self.molecule.forces[self.index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">moldesign.NotCalculatedError</span></code> &#8211; if molecular forces have not been calculated</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.heavy_bonds">
<code class="descname">heavy_bonds</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.heavy_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Bond]</em> &#8211; list of all heavy atom bonds (where BOTH atoms are not hydrogen)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this returns an empty list if called on a hydrogen atom</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.num_bonds">
<code class="descname">num_bonds</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.num_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; the number of other atoms this atom is bonded to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.symbol">
<code class="descname">symbol</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.symbol" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; elemental symbol</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.Atom.velocity">
<code class="descname">velocity</code><a class="headerlink" href="#moldesign.molecules.atoms.Atom.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Vector[length/time, 3]</em> &#8211; velocity of this atom; equivalent to
<code class="docutils literal"><span class="pre">self.momentum/self.mass</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.atoms.AtomDrawingMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atoms.</code><code class="descname">AtomDrawingMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomDrawingMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomDrawingMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions for creating atomic visualizations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.atoms.AtomDrawingMixin.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>width=300</em>, <em>height=300</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomDrawingMixin.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomDrawingMixin.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a 2D and 3D viewer with this atom highlighted (notebook only)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; width of viewer in pixels</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; height of viewer in pixels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">viewer object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ipy.HBox</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.AtomDrawingMixin.draw2d">
<code class="descname">draw2d</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomDrawingMixin.draw2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomDrawingMixin.draw2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a 2D viewer with this atom highlighted (Jupyter only).
In biomolecules, only draws the atom&#8217;s residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; width of viewer in pixels</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; height of viewer in pixels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">viewer object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">mdt.ChemicalGraphViewer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.AtomDrawingMixin.draw3d">
<code class="descname">draw3d</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomDrawingMixin.draw3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomDrawingMixin.draw3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a 3D viewer with this atom highlighted (Jupyter only).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; width of viewer in pixels</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; height of viewer in pixels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">viewer object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">mdt.GeometryViewer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.atoms.AtomGeometryMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atoms.</code><code class="descname">AtomGeometryMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomGeometryMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomGeometryMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions measuring distances between atoms and other things.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.atoms.AtomGeometryMixin.atoms_within">
<code class="descname">atoms_within</code><span class="sig-paren">(</span><em>self</em>, <em>radius</em>, <em>other=None</em>, <em>include_self=False</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.atoms.AtomGeometryMixin.atoms_within" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all atoms in an object within a given radius of this object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>radius</strong> (<em>u.Scalar[length]</em>) &#8211; radius to search for atoms</li>
<li><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><em>AtomContainer</em></a>) &#8211; object containing the atoms to search (default:self.parent)</li>
<li><strong>include_self</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; if True, include the atoms from this object (since, by definition,
their distance from this object is 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of the atoms within <code class="docutils literal"><span class="pre">radius</span></code> of this object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.AtomGeometryMixin.calc_distances">
<code class="descname">calc_distances</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.atoms.AtomGeometryMixin.calc_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>calc_distance_array(self, other=None)
Calculate an array of pairwise distance between all atoms in self and other</p>
<blockquote>
<div><dl class="docutils">
<dt>Args:</dt>
<dd>other (AtomContainer): object to calculate distances to (default: self)</dd>
<dt>Returns:</dt>
<dd>u.Array[length]: 2D array of pairwise distances between the two objects</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_distance_array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.atoms.AtomGeometryMixin.distance">
<code class="descname">distance</code><span class="sig-paren">(</span><em>self</em>, <em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.atoms.AtomGeometryMixin.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns closest distance between this and the other entity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><em>AtomContainer</em></a>) &#8211; object to calculate distance to</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">closest distance between self and other</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">u.Scalar[length]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_distance_array</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.atoms.AtomPropertyMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atoms.</code><code class="descname">AtomPropertyMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomPropertyMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomPropertyMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions accessing computed atomic properties.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="attribute">
<dt id="moldesign.molecules.atoms.AtomPropertyMixin.basis_functions">
<code class="descname">basis_functions</code><a class="headerlink" href="#moldesign.molecules.atoms.AtomPropertyMixin.basis_functions" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[mdt.orbitals.AtomicBasisFunction]</em> &#8211; This atom&#8217;s basis functions, if available
(<code class="docutils literal"><span class="pre">None</span></code> otherwise)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.AtomPropertyMixin.ff">
<code class="descname">ff</code><a class="headerlink" href="#moldesign.molecules.atoms.AtomPropertyMixin.ff" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.utils.DotDict</em> &#8211; This atom&#8217;s force field parameters, if available (<code class="docutils literal"><span class="pre">None</span></code>
otherwise)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.atoms.AtomPropertyMixin.properties">
<code class="descname">properties</code><a class="headerlink" href="#moldesign.molecules.atoms.AtomPropertyMixin.properties" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.utils.DotDict</em> &#8211; Returns any calculated properties for this atom</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.atoms.AtomReprMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.atoms.</code><code class="descname">AtomReprMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomReprMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomReprMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions for printing out various strings related to the atom.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.atoms.AtomReprMixin.markdown_summary">
<code class="descname">markdown_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/atoms.html#AtomReprMixin.markdown_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.atoms.AtomReprMixin.markdown_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a markdown-formatted string describing this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">markdown-formatted string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-moldesign.molecules.biounits">
<span id="moldesign-molecules-biounits-module"></span><h2>moldesign.molecules.biounits module<a class="headerlink" href="#module-moldesign.molecules.biounits" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="moldesign.molecules.biounits.Chain">
<em class="property">class </em><code class="descclassname">moldesign.molecules.biounits.</code><code class="descname">Chain</code><span class="sig-paren">(</span><em>pdbname=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>Biomolecular chain class - its children are almost always residues.</p>
<dl class="attribute">
<dt id="moldesign.molecules.biounits.Chain.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.biounits.Chain.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.Molecule</em> &#8211; the molecule this residue belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Chain.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.biounits.Chain.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; the chain this residue belongs to</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Chain.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>residue</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Chain.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Chain.assign_biopolymer_bonds">
<code class="descname">assign_biopolymer_bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.assign_biopolymer_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Chain.assign_biopolymer_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect bonds between residues in this chain. Does not .</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><span class="xref std std-ref">moldesign.Residue.assign_template_bonds</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if <code class="docutils literal"><span class="pre">residue.resname</span></code> is not in bioresidue templates</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an atom in this residue is not recognized</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Chain.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Chain.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Chain.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Chain.residues">
<code class="descname">residues</code><a class="headerlink" href="#moldesign.molecules.biounits.Chain.residues" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; synonym for &#8216;self&#8217; to enhance readability,
e.g. <code class="docutils literal"><span class="pre">`molecule.chains['A'].residue[123]`</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Chain.sequence">
<code class="descname">sequence</code><a class="headerlink" href="#moldesign.molecules.biounits.Chain.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; this chain&#8217;s residue sequence with one-letter residue codes</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.biounits.Entity">
<em class="property">class </em><code class="descclassname">moldesign.molecules.biounits.</code><code class="descname">Entity</code><span class="sig-paren">(</span><em>name=None</em>, <em>molecule=None</em>, <em>index=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a>, <a class="reference internal" href="moldesign.utils.html#moldesign.utils.classes.DictLike" title="moldesign.utils.classes.DictLike"><code class="xref py py-class docutils literal"><span class="pre">moldesign.utils.classes.DictLike</span></code></a></p>
<p>Generalized storage mechanism for hierarchical representation of biomolecules,
e.g. by residue, chain, etc. Permits other groupings, provided that everything is
tree-like.</p>
<p>All children of a given entity must have unique keys. An individual child can be retrieved with
<code class="docutils literal"><span class="pre">entity.childname</span></code> or <code class="docutils literal"><span class="pre">entity['childname']</span></code> or <code class="docutils literal"><span class="pre">entity[index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Entity or mdt.Atom</em> &#8211; this entity&#8217;s children, in order</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="moldesign.molecules.biounits.Entity.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>item</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Entity.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a child to this entity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an object with this key already exists</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>item</strong> (<em>Entity or mdt.Atom</em>) &#8211; the child object to add</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Key to retrieve this item (default: <code class="docutils literal"><span class="pre">item.name</span></code> )</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; a sorted list of all atoms in this entity and/or its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.indexlist">
<code class="descname">indexlist</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.indexlist" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> &#8211; list of all children, in order</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Entity.iteratoms">
<code class="descname">iteratoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Entity.iteratoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Entity.iteratoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all atoms (i.e. leaf nodes)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Atom</em> &#8211; all atoms in this entity and/or its children</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.mass">
<code class="descname">mass</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[mass]</em> &#8211; total mass of this object</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.natoms">
<code class="descname">natoms</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.natoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.num_atoms">
<code class="descname">num_atoms</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Entity.numatoms">
<code class="descname">numatoms</code><a class="headerlink" href="#moldesign.molecules.biounits.Entity.numatoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms contained in this entity and its children</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.biounits.Instance">
<em class="property">class </em><code class="descclassname">moldesign.molecules.biounits.</code><code class="descname">Instance</code><span class="sig-paren">(</span><em>name=None</em>, <em>molecule=None</em>, <em>index=None</em>, <em>pdbname=None</em>, <em>pdbindex=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>The singleton biomolecular container for each <code class="docutils literal"><span class="pre">Molecule</span></code>. Its children are generally
PDB chains. Users won&#8217;t ever really see this object.</p>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.biounits.Residue">
<em class="property">class </em><code class="descclassname">moldesign.molecules.biounits.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.biounits.Entity" title="moldesign.molecules.biounits.Entity"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.biounits.Entity</span></code></a></p>
<p>A biomolecular residue - most often an amino acid, a nucleic base, or a solvent
molecule. In PDB structures, also often refers to non-biochemical molecules.</p>
<p>Its children are almost always residues.</p>
<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.parent">
<code class="descname">parent</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.parent" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.Molecule</em> &#8211; the molecule this residue belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.chain">
<code class="descname">chain</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.chain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Chain</em> &#8211; the chain this residue belongs to</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Residue.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>atom</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Residue.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized storage mechanism for hierarchical representation of biomolecules,
e.g. by residue, chain, etc. Permits other groupings, provided that everything is
tree-like.</p>
<p>All children of a given entity must have unique keys. An individual child can be retrieved with
<code class="docutils literal"><span class="pre">entity.childname</span></code> or <code class="docutils literal"><span class="pre">entity['childname']</span></code> or <code class="docutils literal"><span class="pre">entity[index]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>Entity or mdt.Atom</em> &#8211; this entity&#8217;s children, in order</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Residue.assign_template_bonds">
<code class="descname">assign_template_bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.assign_template_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Residue.assign_template_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign bonds from bioresidue templates.</p>
<p>Only assigns bonds that are internal to this residue (does not connect different residues).
The topologies here assume pH7.4 and may need to be corrected for other pHs</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><span class="xref std std-ref">moldesign.Chain.assign_biopolymer_bonds</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if <code class="docutils literal"><span class="pre">residue.resname</span></code> is not in bioresidue templates</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> &#8211; if an atom in this residue is not recognized</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.atomnames">
<code class="descname">atomnames</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.atomnames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Residue</em> &#8211; synonym for <code class="docutils literal"><span class="pre">`self`</span></code> for for the sake of readability &#8211; <code class="docutils literal"><span class="pre">`molecule.chains['A'].residues[123].atomnames['CA']`</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.backbone">
<code class="descname">backbone</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.backbone" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; all backbone atoms for nucleic and protein residues
(indentified using PDB names); returns None for other residue types</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.code">
<code class="descname">code</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.code" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; one-letter amino acid code or two letter nucleic acid code, or &#8216;?&#8217; otherwise</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Residue.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Residue.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a group of atoms which may already have bonds, residues, and a parent molecule
assigned. Do so by copying only the relevant entities, and creating a &#8220;mask&#8221; with
deepcopy&#8217;s memo function to stop anything else from being copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of copied atoms</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../toplevel.html#moldesign.AtomList" title="moldesign.AtomList">AtomList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.is_3prime_end">
<code class="descname">is_3prime_end</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.is_3prime_end" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the last base in a strand</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not a DNA base</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.is_5prime_end">
<code class="descname">is_5prime_end</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.is_5prime_end" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the first base in a strand</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not a DNA base</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.is_c_terminal">
<code class="descname">is_c_terminal</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.is_c_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the first residue in a peptide</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not an amino acid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.is_monomer">
<code class="descname">is_monomer</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.is_monomer" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this residue is not part of a biopolymer</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.is_n_terminal">
<code class="descname">is_n_terminal</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.is_n_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; this is the last residue in a peptide</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if this residue is not an amino acid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.biounits.Residue.markdown_summary">
<code class="descname">markdown_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/biounits.html#Residue.markdown_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.biounits.Residue.markdown_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Markdown-formatted information about this residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">markdown-formatted string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.next_residue">
<code class="descname">next_residue</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.next_residue" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt><em>Residue</em> &#8211;     The next residue in the chain (in the C-direction for proteins, 3&#8217;</dt>
<dd>direction for nucleic acids)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code> &#8211; If we don&#8217;t know how to deal with this type of biopolymer</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></code> &#8211; If there isn&#8217;t a next residue (i.e. it&#8217;s a 3&#8217;- or C-terminus)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.prev_residue">
<code class="descname">prev_residue</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.prev_residue" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Residue</em> &#8211;     The next residue in the chain (in the N-direction for proteins, 5&#8217; direction for nucleic acids)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code> &#8211; If we don&#8217;t know how to deal with this type of biopolymer</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">StopIteration</span></code> &#8211; If there isn&#8217;t a previous residue (i.e. it&#8217;s a 5&#8217;- or N-terminus)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.resname">
<code class="descname">resname</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.resname" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; Synonym for pdbname</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.sidechain">
<code class="descname">sidechain</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.sidechain" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; all sidechain atoms for nucleic and protein residues
(defined as non-backbone atoms); returns None for other residue types</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.biounits.Residue.type">
<code class="descname">type</code><a class="headerlink" href="#moldesign.molecules.biounits.Residue.type" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; Classification of the residue (protein, solvent, dna, water, unknown)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-moldesign.molecules.bonds">
<span id="moldesign-molecules-bonds-module"></span><h2>moldesign.molecules.bonds module<a class="headerlink" href="#module-moldesign.molecules.bonds" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="moldesign.molecules.bonds.Bond">
<em class="property">class </em><code class="descclassname">moldesign.molecules.bonds.</code><code class="descname">Bond</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>order=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/bonds.html#Bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.bonds.Bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A bond between two atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a1</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; First atom</li>
<li><strong>a2</strong> (<a class="reference internal" href="#moldesign.molecules.atoms.Atom" title="moldesign.molecules.atoms.Atom"><em>Atom</em></a>) &#8211; Second atom (the order of atoms doesn&#8217;t matter)</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Order of the bond</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Comparisons and hashes involving bonds will return True if the atoms involved in the bonds</dt>
<dd>are the same. Bond orders are not compared.</dd>
</dl>
<p>These objects are used to represent and pass bond data only - they are not used for storage.</p>
<dl class="attribute">
<dt id="moldesign.molecules.bonds.Bond.a1">
<code class="descname">a1</code><a class="headerlink" href="#moldesign.molecules.bonds.Bond.a1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Atom</em> &#8211; First atom in the bond; assigned so that <code class="docutils literal"><span class="pre">self.a1.index</span> <span class="pre">&lt;</span> <span class="pre">self.a2.index</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.bonds.Bond.a2">
<code class="descname">a2</code><a class="headerlink" href="#moldesign.molecules.bonds.Bond.a2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Atom</em> &#8211; Second atom in the bond; assigned so that <code class="docutils literal"><span class="pre">self.a2.index</span> <span class="pre">&gt;</span> <span class="pre">self.a1.index</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.bonds.Bond.order">
<code class="descname">order</code><a class="headerlink" href="#moldesign.molecules.bonds.Bond.order" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; bond order (can be <code class="docutils literal"><span class="pre">None</span></code>); not used in comparisons</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.bonds.Bond.ff">
<code class="descname">ff</code><a class="headerlink" href="#moldesign.molecules.bonds.Bond.ff" title="Permalink to this definition">¶</a></dt>
<dd><p><em>mdt.forcefield.BondTerm</em> &#8211; the force-field term for this bond (or <code class="docutils literal"><span class="pre">None</span></code> if no
forcefield is present)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.bonds.Bond.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.bonds.Bond.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; name of the bond</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.bonds.Bond.partner">
<code class="descname">partner</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/bonds.html#Bond.partner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.bonds.Bond.partner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this atom&#8217;s <em>partner</em> in the bond &#8211; i.e., the other atom in the bond</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong> (<em>mdt.Atom</em>) &#8211; return the atom that this one is bonded to</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the passed atom&#8217;s partner</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mdt.Atom</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211; if the passed atom is not part of this bond</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-moldesign.molecules.coord_arrays">
<span id="moldesign-molecules-coord-arrays-module"></span><h2>moldesign.molecules.coord_arrays module<a class="headerlink" href="#module-moldesign.molecules.coord_arrays" title="Permalink to this headline">¶</a></h2>
<p>This module contains python &#8220;descriptors&#8221; (nothing to do with chemoinformatic &#8220;descriptors&#8221;) that
help maintain the links between an atom&#8217;s coordinates and its molecule&#8217;s coordinates</p>
<dl class="class">
<dt id="moldesign.molecules.coord_arrays.AtomArray">
<em class="property">class </em><code class="descclassname">moldesign.molecules.coord_arrays.</code><code class="descname">AtomArray</code><span class="sig-paren">(</span><em>atomname</em>, <em>moleculename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/coord_arrays.html#AtomArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.coord_arrays.AtomArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.coord_arrays.ProtectedArray" title="moldesign.molecules.coord_arrays.ProtectedArray"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.coord_arrays.ProtectedArray</span></code></a></p>
<p>Descriptor for atom coordinates are stored in the parent molecule.</p>
<p>Makes sure that the arrays and their references are maintained during both
reassignment and copying/pickling
:param atomname: name of the attribute in the atom instance
:type atomname: str
:param parentname: name of the corresponding attribute in the molecule instance
:type parentname: str</p>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.coord_arrays.AtomCoordinate">
<em class="property">class </em><code class="descclassname">moldesign.molecules.coord_arrays.</code><code class="descname">AtomCoordinate</code><span class="sig-paren">(</span><em>attrname</em>, <em>index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/coord_arrays.html#AtomCoordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.coord_arrays.AtomCoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Descriptor for use with the <code class="docutils literal"><span class="pre">Atom</span></code> class.</p>
<p>Gives access to 3D coordinates as <code class="docutils literal"><span class="pre">atom.x,atom.y,atom.z</span></code> instead of
<code class="docutils literal"><span class="pre">atom.position[0],atom.position[1],atom.position[2]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>quantity</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the attribute that this accesses</li>
<li><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; component of the attribute that this accesses</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.coord_arrays.ProtectedArray">
<em class="property">class </em><code class="descclassname">moldesign.molecules.coord_arrays.</code><code class="descname">ProtectedArray</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/coord_arrays.html#ProtectedArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.coord_arrays.ProtectedArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Descriptor for arrays that shouldn&#8217;t be reassigned.
Makes sure array attributes (specifically position and momentum) are modified in place</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the instance attribute</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="moldesign-molecules-molecule-module">
<h2>moldesign.molecules.molecule module<a class="headerlink" href="#moldesign-molecules-molecule-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-moldesign.molecules.molecule"></span><dl class="class">
<dt id="moldesign.molecules.molecule.MolConstraintMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolConstraintMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions for applying and managing geometrical constraints.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Molecule class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolConstraintMixin.clear_constraints">
<code class="descname">clear_constraints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin.clear_constraints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin.clear_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all geometry constraints from the molecule.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This does NOT clear integrator options - such as &#8220;constrain H bonds&#8221;</p>
</div>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolConstraintMixin.constrain_angle">
<code class="descname">constrain_angle</code><span class="sig-paren">(</span><em>atom1</em>, <em>atom2</em>, <em>atom3</em>, <em>angle=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin.constrain_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin.constrain_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond angle atom1-atom2-atom3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom2</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom3</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>angle</strong> (<em>[angle]</em>) &#8211; angle value (default: current angle)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">constraint object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.geometry.AngleConstraint</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolConstraintMixin.constrain_atom">
<code class="descname">constrain_atom</code><span class="sig-paren">(</span><em>atom</em>, <em>pos=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin.constrain_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin.constrain_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the position of an atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; The atom to constrain</li>
<li><strong>pos</strong> (<em>moldesign.units.MdtQuantity</em>) &#8211; position to fix this atom at (default: atom.position) [length]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">constraint object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.geometry.FixedPosition</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolConstraintMixin.constrain_dihedral">
<code class="descname">constrain_dihedral</code><span class="sig-paren">(</span><em>atom1</em>, <em>atom2</em>, <em>atom3</em>, <em>atom4</em>, <em>angle=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin.constrain_dihedral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin.constrain_dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond angle atom1-atom2-atom3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom2</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom3</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom4</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>angle</strong> (<em>[angle]</em>) &#8211; angle value (default: current angle)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">constraint object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.geometry.AngleConstraint</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolConstraintMixin.constrain_distance">
<code class="descname">constrain_distance</code><span class="sig-paren">(</span><em>atom1</em>, <em>atom2</em>, <em>dist=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolConstraintMixin.constrain_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolConstraintMixin.constrain_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the distance between two atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom1</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>atom2</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; </li>
<li><strong>dist</strong> (<em>[length]</em>) &#8211; distance value (default: current distance)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">constraint object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.geometry.DistanceConstraint</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolDrawingMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolDrawingMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolDrawingMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolDrawingMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Methods for visualizing molecular structure.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Molecule class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolDrawingMixin.draw_orbitals">
<code class="descname">draw_orbitals</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolDrawingMixin.draw_orbitals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolDrawingMixin.draw_orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize any calculated molecular orbitals (Jupyter only).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mdt.orbitals.OrbitalViewer</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolPropertyMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolPropertyMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions for calculating and accessing molecular properties.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Molecule class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calc_dipole">
<code class="descname">calc_dipole</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calc_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dipole moment at this position (len=3)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">units.Vector[length*charge]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calc_forces">
<code class="descname">calc_forces</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calc_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">units.Vector[force]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calc_potential_energy">
<code class="descname">calc_potential_energy</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calc_potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate potential energy and return it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">potential energy at this position</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">units.Scalar[energy]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calc_property">
<code class="descname">calc_property</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.calc_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calc_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the given property if necessary and return it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the property (e.g. &#8216;potential_energy&#8217;, &#8216;forces&#8217;, etc.)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the requested property</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)">object</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calc_wfn">
<code class="descname">calc_wfn</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calc_wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">electronic wavefunction object</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">moldesign.orbitals.ElectronicWfn</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calculate_dipole">
<code class="descname">calculate_dipole</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.calculate_dipole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calculate_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dipole moment at this position (len=3)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">units.Vector[length*charge]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calculate_forces">
<code class="descname">calculate_forces</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.calculate_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calculate_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">units.Vector[force]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calculate_potential_energy">
<code class="descname">calculate_potential_energy</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.calculate_potential_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calculate_potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate potential energy and return it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">potential energy at this position</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">units.Scalar[energy]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.calculate_wfn">
<code class="descname">calculate_wfn</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.calculate_wfn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.calculate_wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forces and return them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">electronic wavefunction object</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">moldesign.orbitals.ElectronicWfn</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.dipole">
<code class="descname">dipole</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.dipole" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[length*charge]</em> &#8211; return the molecule&#8217;s dipole moment, if calculated (len=3).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotCalculatedError</span></code> &#8211; If the dipole moment has not yet been calculated at this
geometry</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.dynamic_dof">
<code class="descname">dynamic_dof</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.dynamic_dof" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; Count the number of spatial degrees of freedom of the system,
taking into account any constraints</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If there are other DOFs not taken into account here, this quantity can be
set explicitly</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.forces">
<code class="descname">forces</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.forces" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[force]</em> &#8211; return the current force on the molecule, if calculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotCalculatedError</span></code> &#8211; If the forces have not yet been calculated at this geometry</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.get_property">
<code class="descname">get_property</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.get_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.get_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the given property if already calculated; raise NotCalculatedError otherwise</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the property (e.g. &#8216;potential_energy&#8217;, &#8216;forces&#8217;, etc.)</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotCalculatedError</span></code> &#8211; If the molecular property has not yet been calculated at this
geometry</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the requested property</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)">object</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.homo">
<code class="descname">homo</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.homo" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; The array index (0-based) of the highest occupied molecular orbital (HOMO).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This assumes a closed shell ground state!</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.kinetic_energy">
<code class="descname">kinetic_energy</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[energy]</em> &#8211; Classical kinetic energy <span class="math">\(\sum_{\text{atoms}} \frac{p^2}{2m}\)</span></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.kinetic_temperature">
<code class="descname">kinetic_temperature</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.kinetic_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p><em>[temperature]</em> &#8211; temperature calculated using the equipartition theorem,</p>
<p><span class="math">\(\frac{2 E_{\text{kin}}}{k_b f}\)</span>,</p>
<p>where <span class="math">\(E_{\text{kin}}\)</span> is the kinetic energy and <span class="math">\(f\)</span> is the number of
degrees of freedom (see <code class="xref py py-meth docutils literal"><span class="pre">dynamic_dof</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.lumo">
<code class="descname">lumo</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.lumo" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; The array index (0-based) of the lowest unoccupied molecular orbital (LUMO).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This assumes a closed shell ground state!</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.mass">
<code class="descname">mass</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[mass]</em> &#8211; the molecule&#8217;s mass</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.num_electrons">
<code class="descname">num_electrons</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.num_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; The number of electrons in the system, based on the atomic numbers and self.charge</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.potential_energy">
<code class="descname">potential_energy</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Scalar[energy]</em> &#8211; return the molecule&#8217;s current potential energy, if calculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotCalculatedError</span></code> &#8211; If the potential energy has not yet been calculated at this
geometry</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.properties">
<code class="descname">properties</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.properties" title="Permalink to this definition">¶</a></dt>
<dd><p><em>MolecularProperties</em> &#8211; Molecular properties calculated at this geometry</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.update_properties">
<code class="descname">update_properties</code><span class="sig-paren">(</span><em>properties</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolPropertyMixin.update_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.update_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>This is intended mainly as a callback for long-running property calculations.
When they are finished, they can call this method to update the molecule&#8217;s properties.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; properties-like object. MUST contain a &#8216;positions&#8217; attribute.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.MolPropertyMixin.wfn">
<code class="descname">wfn</code><a class="headerlink" href="#moldesign.molecules.molecule.MolPropertyMixin.wfn" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.orbitals.ElectronicWfn</em> &#8211; return the molecule&#8217;s current electronic state,
if calculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotCalculatedError</span></code> &#8211; If the electronic state has not yet been calculated at this
geometry</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolReprMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolReprMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolReprMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolReprMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Methods for creating text-based representations of the molecule</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Molecule class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolReprMixin.biomol_summary_markdown">
<code class="descname">biomol_summary_markdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolReprMixin.biomol_summary_markdown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolReprMixin.biomol_summary_markdown" title="Permalink to this definition">¶</a></dt>
<dd><p>A markdown description of biomolecular structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Markdown string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolReprMixin.get_residue_table">
<code class="descname">get_residue_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolReprMixin.get_residue_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolReprMixin.get_residue_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a data table summarizing this molecule&#8217;s primary structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">moldesign.utils.MarkdownTable</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolReprMixin.get_stoichiometry">
<code class="descname">get_stoichiometry</code><span class="sig-paren">(</span><em>html=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolReprMixin.get_stoichiometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolReprMixin.get_stoichiometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this molecule&#8217;s stoichiometry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolReprMixin.markdown_summary">
<code class="descname">markdown_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolReprMixin.markdown_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolReprMixin.markdown_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>A markdown description of this molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Markdown</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolSimulationMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolSimulationMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions calculating energies, running dynamics, and minimizing geometry.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>requests=None</em>, <em>wait=True</em>, <em>use_cache=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.calculate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a potential energy calculation on the current geometry, returning the requested quantities.
If <cite>requests</cite> is not passed, the properties specified in the energy_models DEFAULT_PROPERTIES
will be calculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>requests</strong> (<em>List[str]</em>) &#8211; list of quantities for the model to calculate,
e.g. [&#8216;dipole&#8217;, &#8216;forces&#8217;]</li>
<li><strong>wait</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; if True, wait for the calculation to complete before returning.                  If false, return a job object - this will not update the molecule&#8217;s properties!</li>
<li><strong>use_cache</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Return cached results if possible</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">MolecularProperties</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.configure_methods">
<code class="descname">configure_methods</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.configure_methods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.configure_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactively configure this molecule&#8217;s simulation methods (notebooks only)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">configuration widget</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ipywidgets.Box</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.minimize">
<code class="descname">minimize</code><span class="sig-paren">(</span><em>mol</em>, <em>nsteps=20</em>, <em>force_tolerance=&lt;Quantity(0.00514220566583</em>, <em>'eV / ang')&gt;</em>, <em>frame_interval=None</em>, <em>restraint_multiplier=1.0</em>, <em>_restart_from=0</em>, <em>_restart_energy=None</em>, <em>assert_converged=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.minimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a minimization based on the potential model.</p>
<p>If force_tolerance is not specified, the program defaults are used.
If specified, the largest force component must be less than force_tolerance
and the RMSD must be less than 1/3 of it. (based on GAMESS OPTTOL keyword)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>assert_converged</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Raise an exception if the minimization does not converged.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">moldesign.trajectory.Trajectory</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>run_for</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the integrator&#8217;s default integration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>run_for</strong> (<em>int or [time]</em>) &#8211; number of steps or amount of time to run for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">moldesign.trajectory.Trajectory</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.set_energy_model">
<code class="descname">set_energy_model</code><span class="sig-paren">(</span><em>model</em>, <em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.set_energy_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.set_energy_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Associate an energy model with this molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>moldesign.methods.EnergyModelBase</em>) &#8211; The energy model to associate with this
molecule</li>
<li><strong>**params</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; a dictionary of parameters for the model</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, <code class="docutils literal"><span class="pre">model</span></code> can be an instance, a class, or a constructor (with
call signature <code class="docutils literal"><span class="pre">model(**params)</span> <span class="pre">-&gt;</span> <span class="pre">model</span> <span class="pre">instance)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolSimulationMixin.set_integrator">
<code class="descname">set_integrator</code><span class="sig-paren">(</span><em>integrator</em>, <em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolSimulationMixin.set_integrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolSimulationMixin.set_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Associate an integrator with this molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>integrator</strong> (<em>moldesign.integrators.IntegratorBase</em>) &#8211; The integrator to associate with this
molecule</li>
<li><strong>**params</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; a dictionary of parameters for the integrator</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, <code class="docutils literal"><span class="pre">integrator</span></code> can be an instance, a class, or a constructor (with
call signature <code class="docutils literal"><span class="pre">integrator(**params)</span> <span class="pre">-&gt;</span> <span class="pre">integrator</span> <span class="pre">instance)</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolTopologyMixin">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolTopologyMixin</code><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolTopologyMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolTopologyMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Functions for building and keeping track of bond topology and biochemical structure.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mixin class designed only to be mixed into the <a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule"><code class="xref py py-class docutils literal"><span class="pre">Molecule</span></code></a> class. Routines
are separated are here for code organization only - they could be included in the main
Atom class without changing any functionality</p>
</div>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolTopologyMixin.assert_atom">
<code class="descname">assert_atom</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolTopologyMixin.assert_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolTopologyMixin.assert_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>If passed an integer, just return self.atoms[atom].
Otherwise, assert that the atom belongs to this molecule</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.MolTopologyMixin.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolTopologyMixin.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolTopologyMixin.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a copy of the molecule and all of its substructures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">copied molecule</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#moldesign.molecules.molecule.Molecule" title="moldesign.molecules.molecule.Molecule">Molecule</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assigned energy models and integrators are not currently copied, although properties are</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.MolecularProperties">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">MolecularProperties</code><span class="sig-paren">(</span><em>mol</em>, <em>**properties</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolecularProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolecularProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="moldesign.utils.html#moldesign.utils.classes.DotDict" title="moldesign.utils.classes.DotDict"><code class="xref py py-class docutils literal"><span class="pre">moldesign.utils.classes.DotDict</span></code></a></p>
<p>Stores property values for a molecule.
These objects will be generally created and updated by EnergyModels, not by users.</p>
<dl class="method">
<dt id="moldesign.molecules.molecule.MolecularProperties.geometry_matches">
<code class="descname">geometry_matches</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#MolecularProperties.geometry_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.MolecularProperties.geometry_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
bool: True if the molecule&#8217;s <code class="docutils literal"><span class="pre">position</span></code> is the same as these properties&#8217; <code class="docutils literal"><span class="pre">position</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.molecule.Molecule">
<em class="property">class </em><code class="descclassname">moldesign.molecules.molecule.</code><code class="descname">Molecule</code><span class="sig-paren">(</span><em>atomcontainer</em>, <em>name=None</em>, <em>bond_graph=None</em>, <em>copy_atoms=False</em>, <em>pdbname=None</em>, <em>charge=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moldesign.molecules.atomcollections.AtomContainer" title="moldesign.molecules.atomcollections.AtomContainer"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.atomcollections.AtomContainer</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolConstraintMixin" title="moldesign.molecules.molecule.MolConstraintMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolConstraintMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolPropertyMixin" title="moldesign.molecules.molecule.MolPropertyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolPropertyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolDrawingMixin" title="moldesign.molecules.molecule.MolDrawingMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolDrawingMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolReprMixin" title="moldesign.molecules.molecule.MolReprMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolReprMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolTopologyMixin" title="moldesign.molecules.molecule.MolTopologyMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolTopologyMixin</span></code></a>, <a class="reference internal" href="#moldesign.molecules.molecule.MolSimulationMixin" title="moldesign.molecules.molecule.MolSimulationMixin"><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.molecule.MolSimulationMixin</span></code></a></p>
<p><code class="docutils literal"><span class="pre">Molecule</span></code> objects store a molecular system, including atoms, 3D coordinates, molecular
properties, biomolecular entities, and other model-specific information. Interfaces with
simulation models take place through the molecule object.</p>
<p>Molecule objects will generally be created by reading files or parsing other input; see, for
example: <a class="reference internal" href="../toplevel.html#moldesign.read" title="moldesign.read"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.read()</span></code></a>, <a class="reference internal" href="../toplevel.html#moldesign.from_smiles" title="moldesign.from_smiles"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.from_smiles()</span></code></a>,
<a class="reference internal" href="../toplevel.html#moldesign.from_pdb" title="moldesign.from_pdb"><code class="xref py py-meth docutils literal"><span class="pre">moldesign.from_pdb()</span></code></a>, etc.</p>
<p>This constructor is useful, however for copying other molecular structures (see
examples below).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atomcontainer</strong> (<em>AtomContainer or AtomList or List[moldesign.Atom]</em>) &#8211; <p>atoms that make up
this molecule.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the passed atoms don&#8217;t already belong to a molecule, they will be assigned
to this one. If they DO already belong to a molecule, they will be copied,
leaving the original molecule untouched.</p>
</div>
</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the molecule (automatically generated if not provided)</li>
<li><strong>bond_graph</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dictionary specifying bonds between the atoms - of the form
<code class="docutils literal"><span class="pre">{atom1:{atom2:bond_order,</span> <span class="pre">atom3:bond_order},</span> <span class="pre">atom2:...}</span></code>
This structure must be symmetric; we require
<code class="docutils literal"><span class="pre">bond_graph[atom1][atom2]</span> <span class="pre">==</span> <span class="pre">bond_graph[atom2][atom1]</span></code></li>
<li><strong>copy_atoms</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create the molecule with <em>copies</em> of the passed atoms
(they will be copied automatically if they already belong to another molecule)</li>
<li><strong>pdbname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the PDB file</li>
<li><strong>charge</strong> (<em>units.Scalar[charge]</em>) &#8211; molecule&#8217;s formal charge</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Use the <code class="docutils literal"><span class="pre">Molecule</span></code> class to create copies of other molecules and substructures thereof:
&gt;&gt;&gt; benzene = mdt.from_name(&#8216;benzene&#8217;)
&gt;&gt;&gt; benzene_copy = mdt.Molecule(benzene, name=&#8217;benzene copy&#8217;)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">protein</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">from_pdb</span><span class="p">(</span><span class="s1">&#39;3AID&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">carbon_copies</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">Molecule</span><span class="p">([</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">protein</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">atnum</span><span class="o">==</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_residue_copy</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Molecule instance attributes:</strong></p>
<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomList</em> &#8211; List of all atoms in this molecule.</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.bond_graph">
<code class="descname">bond_graph</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.bond_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> &#8211; symmetric dictionary specifying bonds between the
atoms:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">bond_graph</span> <span class="pre">=</span> <span class="pre">{atom1:{atom2:bond_order,</span> <span class="pre">atom3:bond_order},</span> <span class="pre">atom2:...}</span></code></p>
<p><code class="docutils literal"><span class="pre">bond_graph[atom1][atom2]</span> <span class="pre">==</span> <span class="pre">bond_graph[atom2][atom1]</span></code></p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.residues">
<code class="descname">residues</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.residues" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[moldesign.Residue]</em> &#8211; flat list of all biomolecular residues in this molecule</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.chains">
<code class="descname">chains</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.chains" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Dict[moldesign.Chain]</em> &#8211; Biomolecular chains - individual chains can be
accessed as <code class="docutils literal"><span class="pre">mol.chains[list_index]</span></code> or <code class="docutils literal"><span class="pre">mol.chains[chain_name]</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.name">
<code class="descname">name</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; A descriptive name for molecule</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.charge">
<code class="descname">charge</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.charge" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Scalar[charge]</em> &#8211; molecule&#8217;s formal charge</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.ndims">
<code class="descname">ndims</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.ndims" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; length of the positions, momenta, and forces arrays (usually 3*self.num_atoms)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.num_atoms">
<code class="descname">num_atoms</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.num_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of atoms (synonyms: num_atoms, numatoms)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.positions">
<code class="descname">positions</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.positions" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[length]</em> &#8211; Nx3 array of atomic positions</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.momenta">
<code class="descname">momenta</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.momenta" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[momentum]</em> &#8211; Nx3 array of atomic momenta</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.masses">
<code class="descname">masses</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Vector[mass]</em> &#8211; vector of atomic masses</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.dim_masses">
<code class="descname">dim_masses</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.dim_masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Array[mass]</em> &#8211; Nx3 array of atomic masses (for numerical convenience -
allows you to calculate velocity, for instance, as
<code class="docutils literal"><span class="pre">velocity</span> <span class="pre">=</span> <span class="pre">mol.momenta/mol.dim_masses</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.time">
<code class="descname">time</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.time" title="Permalink to this definition">¶</a></dt>
<dd><p><em>units.Scalar[time]</em> &#8211; current time in dynamics</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.energy_model">
<code class="descname">energy_model</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.energy_model" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.models.base.EnergyModelBase</em> &#8211; Object that calculates
molecular properties - driven by <cite>mol.calculate()</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.integrator">
<code class="descname">integrator</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.integrator" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.integrators.base.IntegratorBase</em> &#8211; Object that drives movement of 3D
coordinates in time, driven by mol.run()</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.is_biomolecule">
<code class="descname">is_biomolecule</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.is_biomolecule" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; True if this molecule contains at least 2 biochemical residues</p>
</dd></dl>

<p><strong>Molecule methods and properties</strong></p>
<p>See also methods offered by the mixin superclasses:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.AtomContainer</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolPropertyMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolDrawingMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolSimulationMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolTopologyMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolConstraintMixin</span></code></li>
<li><code class="xref py py-class docutils literal"><span class="pre">moldesign.molecules.MolReprMixin</span></code></li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="moldesign.molecules.molecule.Molecule.addatom">
<code class="descname">addatom</code><span class="sig-paren">(</span><em>newatom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.addatom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.addatom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new atom to the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>newatom</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; The atom to add
(it will be copied if it already belongs to a molecule)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.Molecule.addatoms">
<code class="descname">addatoms</code><span class="sig-paren">(</span><em>newatoms</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.addatoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.addatoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new atoms to this molecule.
For now, we really just rebuild the entire molecule in place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>newatoms</strong> (<em>List[moldesign.Atom]</em>) &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over all bonds in the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>moldesign.atoms.Bond</em> &#8211; bond object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.Molecule.deletebond">
<code class="descname">deletebond</code><span class="sig-paren">(</span><em>bond</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.deletebond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.deletebond" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove this bond from the molecule&#8217;s topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>Bond</strong> &#8211; bond to remove</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.is_small_molecule">
<code class="descname">is_small_molecule</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.is_small_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; True if molecule&#8217;s mass is less than 500 Daltons (not mutually exclusive with
<a class="reference internal" href="#moldesign.molecules.molecule.Molecule.is_biomolecule" title="moldesign.molecules.molecule.Molecule.is_biomolecule"><code class="xref py py-meth docutils literal"><span class="pre">self.is_biomolecule</span></code></a>)</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.Molecule.newbond">
<code class="descname">newbond</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.newbond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.newbond" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new bond</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a1</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; First atom in the bond</li>
<li><strong>a2</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Atom" title="moldesign.Atom"><em>moldesign.Atom</em></a>) &#8211; Second atom in the bond</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; order of the bond</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">moldesign.Bond</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.molecule.Molecule.velocities">
<code class="descname">velocities</code><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Vector[length/time]</em> &#8211; Nx3 array of atomic velocities</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.molecule.Molecule.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/molecule.html#Molecule.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.molecule.Molecule.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write this molecule to a string or file.</p>
<p>This is a convenience method for <span class="xref std std-ref">moldesign.converters.write</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; filename to write (if not passed, write to string)</li>
<li><strong>format</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; file format (if filename is not passed, format must be specified)
Guessed from file extension if not passed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-moldesign.molecules.trajectory">
<span id="moldesign-molecules-trajectory-module"></span><h2>moldesign.molecules.trajectory module<a class="headerlink" href="#module-moldesign.molecules.trajectory" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="moldesign.molecules.trajectory.Frame">
<em class="property">class </em><code class="descclassname">moldesign.molecules.trajectory.</code><code class="descname">Frame</code><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="moldesign.utils.html#moldesign.utils.classes.DotDict" title="moldesign.utils.classes.DotDict"><code class="xref py py-class docutils literal"><span class="pre">moldesign.utils.classes.DotDict</span></code></a></p>
<p>A snapshot of a molecule during its motion. This is really just a dictionary of properties.
These properties are those accessed as <code class="docutils literal"><span class="pre">molecule.properties</span></code>, and can vary
substantially depending on the origin of the trajectory. They also include relevant dynamical
data and metadata (such as <code class="docutils literal"><span class="pre">time</span></code>, <code class="docutils literal"><span class="pre">momenta</span></code>, <code class="docutils literal"><span class="pre">minimization_step</span></code>, etc.)</p>
<p>Properties can be accessed either as attributes (<code class="docutils literal"><span class="pre">frame.property_name</span></code>) or as keys
(<code class="docutils literal"><span class="pre">frame['property_name']</span></code>)</p>
<p>Some properties with specific meaning are described below:</p>
<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Frame.annotation">
<code class="descname">annotation</code><a class="headerlink" href="#moldesign.molecules.trajectory.Frame.annotation" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; text describing this frame (will be displayed automatically when
visualized)</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Frame.minimization_step">
<code class="descname">minimization_step</code><a class="headerlink" href="#moldesign.molecules.trajectory.Frame.minimization_step" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; for minimization trajectories</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Frame.time">
<code class="descname">time</code><a class="headerlink" href="#moldesign.molecules.trajectory.Frame.time" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.Scalar[time]</em> &#8211; time during a dynamical trajectory</p>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">mdt</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;benzene&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">set_potential_model</span><span class="p">(</span><span class="n">moldesign</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;3-21g&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">minimize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starting_frame</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">starting_frame</span><span class="o">.</span><span class="n">potential_energy</span> <span class="o">&gt;=</span> <span class="n">traj</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">potential_energy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">starting_frame</span><span class="o">.</span><span class="n">minimization_step</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.trajectory.SubSelection">
<em class="property">class </em><code class="descclassname">moldesign.molecules.trajectory.</code><code class="descname">SubSelection</code><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#SubSelection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.SubSelection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Descriptors to get bits of the trajectory
trajectory.atoms[3].position -&gt; array of positions
trajectory.atoms[5].distance( mol.chains[&#8216;B&#8217;].residues[5] ) -&gt; array of distances
trajectory.chains[&#8216;A&#8217;].residue[23].com -&gt; array of COMs
NOT IMPLEMENTED YET</p>
</dd></dl>

<dl class="class">
<dt id="moldesign.molecules.trajectory.Trajectory">
<em class="property">class </em><code class="descclassname">moldesign.molecules.trajectory.</code><code class="descname">Trajectory</code><span class="sig-paren">(</span><em>mol</em>, <em>unit_system=None</em>, <em>first_frame=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A <code class="docutils literal"><span class="pre">Trajectory</span></code> stores information about a molecule&#8217;s motion and how its properties
change as it moves.</p>
<dl class="docutils">
<dt>A trajectory object contains</dt>
<dd><ol class="first last arabic simple">
<li>a reference to the <a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><code class="xref py py-class docutils literal"><span class="pre">moldesign.Molecule</span></code></a> it describes, and</li>
<li>a list of <a class="reference internal" href="#moldesign.molecules.trajectory.Frame" title="moldesign.molecules.trajectory.Frame"><code class="xref py py-class docutils literal"><span class="pre">Frame</span></code></a> objects, each one containing a snapshot of the molecule at a</li>
</ol>
</dd>
</dl>
<p>particular point in its motion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<a class="reference internal" href="../toplevel.html#moldesign.Molecule" title="moldesign.Molecule"><em>moldesign.Molecule</em></a>) &#8211; the trajectory will describe the motion of this molecule</li>
<li><strong>unit_system</strong> (<em>u.UnitSystem</em>) &#8211; convert all attributes to this unit system (default:
<code class="docutils literal"><span class="pre">moldesign.units.default</span></code>)</li>
<li><strong>first_frame</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create the trajectory&#8217;s first <a class="reference internal" href="#moldesign.molecules.trajectory.Frame" title="moldesign.molecules.trajectory.Frame"><code class="xref py py-class docutils literal"><span class="pre">Frame</span></code></a> from the molecule&#8217;s
current position</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.mol">
<code class="descname">mol</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.mol" title="Permalink to this definition">¶</a></dt>
<dd><p><em>moldesign.Molecule</em> &#8211; the molecule object that this trajectory comes from</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.frames">
<code class="descname">frames</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.frames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Frame]</em> &#8211; a list of the trajectory frames in the order they were created</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.info">
<code class="descname">info</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.info" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; text describing this trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.unit_system">
<code class="descname">unit_system</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.unit_system" title="Permalink to this definition">¶</a></dt>
<dd><p><em>u.UnitSystem</em> &#8211; convert all attributes to this unit system</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.DONOTAPPLY">
<code class="descname">DONOTAPPLY</code><em class="property"> = set(['kinetic_energy'])</em><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.DONOTAPPLY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.MOL_ATTRIBUTES">
<code class="descname">MOL_ATTRIBUTES</code><em class="property"> = ['positions', 'momenta', 'time']</em><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.MOL_ATTRIBUTES" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[str]</em> &#8211; Always store these molecular attributes</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.align_orbital_phases">
<code class="descname">align_orbital_phases</code><span class="sig-paren">(</span><em>reference_frame=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.align_orbital_phases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.align_orbital_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to remove orbital sign flips between frames.
If <cite>reference_frame</cite> is not passed, we&#8217;ll start with frame 0 and
align successive pairs of orbitals.
If <cite>reference_frame</cite> is an int, we&#8217;ll move forwards and backwards from that frame number.
Otherwise, we&#8217;ll try to align every orbital frame to those in reference_frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reference_frame</strong> (<em>int or Frame</em>) &#8211; <code class="docutils literal"><span class="pre">Frame</span></code> containing the orbitals to align with
(default: align each frame with the previous one)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.apply_frame">
<code class="descname">apply_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.apply_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.apply_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct the underlying molecule with the given frame.
Right now, any data not passed is ignored, which may result in properties that aren&#8217;t synced up
with each other ...</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.draw3d">
<code class="descname">draw3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.draw3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.draw3d" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.draw_orbitals">
<code class="descname">draw_orbitals</code><span class="sig-paren">(</span><em>align=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.draw_orbitals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.draw_orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>TrajectoryOrbViewer: create a trajectory visualization</p>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.kinetic_energy">
<code class="descname">kinetic_energy</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.kinetic_temperature">
<code class="descname">kinetic_temperature</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.kinetic_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.new_frame">
<code class="descname">new_frame</code><span class="sig-paren">(</span><em>properties=None</em>, <em>**additional_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.new_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.new_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new frame, EITHER from the parent molecule or from a list of properties</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dictionary of properties (i.e. {&#8216;positions&#8217;:[...],</li>
<li><strong>'potential_energy'</strong> &#8211; ...})</li>
<li><strong>**additional_data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; any additional data to be added to the trajectory frame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">frame number (0-based)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="moldesign.molecules.trajectory.Trajectory.num_frames">
<code class="descname">num_frames</code><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.num_frames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; number of frames in this trajectory</p>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a matplotlib plot of property x against property y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x,y</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; names of the properties</li>
<li><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; kwargs for <code class="xref py py-meth docutils literal"><span class="pre">matplotlib.pylab.plot()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the lines that were plotted</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List[matplotlib.lines.Lines2D]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.rmsd">
<code class="descname">rmsd</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>reference=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate root-mean-square displacement for each frame in the trajectory.</p>
<p>The RMSD between times <span class="math">\(t\)</span> and <span class="math">\(t0\)</span> is given by</p>
<p><span class="math">\(\text{RMSD}(t;t_0) =\sqrt{\sum_{i \in \text{atoms}} \left( \mathbf{R}_i(t) -
\mathbf{R}_i(t_0) \right)^2}\)</span>,</p>
<p>where <span class="math">\(\mathbf{R}_i(t)\)</span> is the position of atom <em>i</em> at time <em>t</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list[mdt.Atom]</em>) &#8211; list of atoms to calculate the RMSD for (all atoms in the
<code class="docutils literal"><span class="pre">Molecule</span></code>)</li>
<li><strong>reference</strong> (<em>u.Vector[length]</em>) &#8211; Reference positions for RMSD. (default:
<code class="docutils literal"><span class="pre">traj.frames[0].positions</span></code>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of RMSD displacements for each frame in the trajectory</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">u.Vector[length]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.slice_frames">
<code class="descname">slice_frames</code><span class="sig-paren">(</span><em>key</em>, <em>missing=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.slice_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.slice_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of giving the value of <code class="docutils literal"><span class="pre">key</span></code> at each frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of the property, e.g., time, potential_energy, annotation, etc</li>
<li><strong>missing</strong> &#8211; value to return if a given frame does not have this property</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>vector containing the value at each frame, or the value given</dt>
<dd><p class="first last">in the <code class="docutils literal"><span class="pre">missing</span></code> keyword) (len= <cite>len(self)</cite> )</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">moldesign.units.Vector</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="moldesign.molecules.trajectory.Trajectory.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/moldesign/molecules/trajectory.html#Trajectory.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#moldesign.molecules.trajectory.Trajectory.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="moldesign.orbitals.html" class="btn btn-neutral float-right" title="moldesign.orbitals package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="moldesign.models.html" class="btn btn-neutral" title="moldesign.models package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 Autodesk Research.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.7.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>